(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{21:function(e,t,a){e.exports=a(46)},26:function(e,t,a){},30:function(e,t,a){},32:function(e,t,a){},42:function(e,t,a){},46:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(18),o=a.n(c),l=(a(26),a(6)),s=a(7),i=a(9),m=a(8),u=a(10),h=a(50),d=a(49),p=a(2),f=a(11),E=a.n(f),v=a(12),b=(a(30),a(32),a(47)),g=a(20);function j(e){return r.a.createElement("div",{className:"container-fluid text-center"},r.a.createElement(N,{points:e.match}),r.a.createElement(O,{sets:e.match.pointage.manches}),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md text-center"},r.a.createElement("p",null,"Jeux"))),r.a.createElement(w,{jeux:e.match.pointage.jeu}),r.a.createElement(k,{contest:e.match.constestation}))}function N(e){var t=15*e.points.pointage.echange[0],a=15*e.points.pointage.echange[1];return t>40&&(t=40),a>40&&(a=40),e.points.pointage.end?r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-4 offset-md-4 text-center"},r.a.createElement("h2",{className:"text-danger"},"Match termin\xe9"),r.a.createElement("span",null,r.a.createElement("i",null,"Dur\xe9e : ",Math.floor(e.points.temps_partie/60)," minutes")),r.a.createElement("hr",{className:"my-4"}))):e.points.temps_partie?r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-4 offset-md-4 text-center"},r.a.createElement("h2",{className:"text-success"},"Match en cours"),r.a.createElement("span",null,r.a.createElement("i",null,"Depuis ",Math.floor(e.points.temps_partie/60)," minutes")),r.a.createElement("hr",{className:"my-4"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md text-center"},r.a.createElement("p",null,"Points"))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-3 offset-md-2"},r.a.createElement("p",null,t)),r.a.createElement("div",{className:"col-md-2"},r.a.createElement("p",null,"-")),r.a.createElement("div",{className:"col-md-3"},r.a.createElement("p",null,a)))):r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-4 offset-md-4 text-center"},r.a.createElement("h2",{className:"text-warning"},"Match \xe0 venir"),r.a.createElement("hr",{className:"my-4"})))}function w(e){var t=e.jeux.map(function(e,t){return r.a.createElement("div",{key:t++},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-3 offset-md-2"},r.a.createElement("p",null,e[0])),r.a.createElement("div",{className:"col-md-2"},r.a.createElement("p",null,"-")),r.a.createElement("div",{className:"col-md-3"},r.a.createElement("p",null,e[1]))))});return r.a.createElement("div",null,t)}function O(e){return r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md text-center"},r.a.createElement("p",null,"Sets"))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-3 offset-md-2"},r.a.createElement("p",null,e.sets[0])),r.a.createElement("div",{className:"col-md-2"},r.a.createElement("p",null,"-")),r.a.createElement("div",{className:"col-md-3"},r.a.createElement("p",null,e.sets[1]))))}function k(e){return r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md text-center"},r.a.createElement("p",null,"Contestations restantes"))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-3 offset-md-2"},r.a.createElement("p",null,e.contest[0])),r.a.createElement("div",{className:"col-md-2"},r.a.createElement("p",null,"-")),r.a.createElement("div",{className:"col-md-3"},r.a.createElement("p",null,e.contest[1]))))}function y(e){return r.a.createElement("div",{className:"container-fluid text-center"},r.a.createElement("button",{disabled:e.pointage.end,className:"btn btn-success btn-lg",onClick:function(t){return e.update()}},"Update"),r.a.createElement("button",{disabled:e.pointage.manches[0]>0||e.pointage.manches[1]>0,className:"offset-md-4 btn btn-danger btn-lg",onClick:function(t){return e.parier()}},"Parier"))}function x(e){return r.a.createElement("div",null,r.a.createElement("div",{className:"container-fluid text-center"},r.a.createElement("h1",{className:"display-4"},e.match.joueur1.prenom," ",e.match.joueur1.nom,r.a.createElement("b",null," - VS - "),e.match.joueur2.prenom," ",e.match.joueur2.nom)),r.a.createElement("hr",{className:"my-4"}),r.a.createElement(j,{match:e.match}),r.a.createElement("hr",{className:"my-4"}),r.a.createElement(y,{pointage:e.match.pointage,update:e.update,parier:e.parier}))}var S=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(i.a)(this,Object(m.a)(t).call(this,e))).fetchMatch=Object(v.a)(E.a.mark(function e(){var t,n;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/parties/".concat(a.props.location.state.match.id));case 2:return t=e.sent,e.next=5,t.json();case 5:if(n=e.sent,200===t.status){e.next=8;break}throw Error(n.message);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}},e,this)})),a.state={match:[],matchUpdated:!1,toPari:!1},a.setMatch=a.setMatch.bind(Object(p.a)(Object(p.a)(a))),a.parier=a.parier.bind(Object(p.a)(Object(p.a)(a))),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setMatch(),this.timerID=setInterval(function(){return e.tick()},5e3)}},{key:"tick",value:function(){this.state.match.pointage.end?clearInterval(this.timerID):this.setMatch()}},{key:"parier",value:function(){this.setState({toPari:!0})}},{key:"setMatch",value:function(){var e=this;this.fetchMatch().then(function(t){e.setState({match:t,matchUpdated:!0})}).catch(function(t){console.log(t),e.setState({matchUpdated:!1})})}},{key:"render",value:function(){return this.props.location.state?this.state.toPari?r.a.createElement(b.a,{push:!0,to:{pathname:"/pari",state:{match:this.state.match}}}):r.a.createElement("section",{className:"jumbotron"},r.a.createElement(g,{loaded:this.state.matchUpdated},r.a.createElement(x,{match:this.state.match,update:this.setMatch,parier:this.parier}))):r.a.createElement(b.a,{push:!0,to:{pathname:"/"}})}},{key:"componentWillUnmount",value:function(){clearInterval(this.timerID)}}]),t}(n.Component),M=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(i.a)(this,Object(m.a)(t).call(this,e))).fetchMatchs=Object(v.a)(E.a.mark(function e(){var t,a;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/parties");case 2:return t=e.sent,e.next=5,t.json();case 5:if(a=e.sent,200===t.status){e.next=8;break}throw Error(a.message);case 8:return e.abrupt("return",a);case 9:case"end":return e.stop()}},e,this)})),a.state={response:[]},a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;navigator.onLine?this.fetchMatchs().then(function(t){e.setState({response:t}),localStorage.setItem("matchs",JSON.stringify(t))}).catch(function(e){return console.log(e)}):(console.log("OUI"),localStorage.getItem("matchs")&&this.setState({response:JSON.parse(localStorage.getItem("matchs"))}))}},{key:"render",value:function(){return r.a.createElement("table",{className:"table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{scope:"col"}),r.a.createElement("th",{scope:"col"},"Joueurs"),r.a.createElement("th",{scope:"col"},"Heure"),r.a.createElement("th",{scope:"col"},"Sets"),r.a.createElement("th",{scope:"col"},"Jeux"),r.a.createElement("th",{scope:"col"},"Tournoi"))),r.a.createElement(P,{matchs:this.state.response,click:this.props.toMatch}))}}]),t}(n.Component);function P(e){var t=e.matchs.map(function(t){return r.a.createElement("tr",{key:t.id,onClick:function(a){return e.click(t)}},r.a.createElement("th",{scope:"row"},t.pointage.end?"Termin\xe9":t.temps_partie?"En cours":"A venir"),r.a.createElement("td",null,t.joueur1.prenom," ",t.joueur1.nom," - ",r.a.createElement("b",null,"VS")," - ",t.joueur2.prenom," ",t.joueur2.nom),r.a.createElement("td",null,t.heure_debut),r.a.createElement("td",null,t.pointage.manches[0]," - ",t.pointage.manches[1]),r.a.createElement(C,{jeux:t.pointage.jeu}),r.a.createElement("td",null,t.tournoi))});return r.a.createElement("tbody",null,t)}function C(e){var t=e.jeux.map(function(e,t){return r.a.createElement("span",{key:t++},e[0]," - ",e[1],r.a.createElement("br",null))});return r.a.createElement("td",null,t)}function D(e){return r.a.createElement("h1",null,"Matchs de Tennis")}var I=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(i.a)(this,Object(m.a)(t).call(this,e))).state={toMatch:!1,match:[]},a.toMatch=a.toMatch.bind(Object(p.a)(Object(p.a)(a))),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"toMatch",value:function(e){this.setState({match:e,toMatch:!0})}},{key:"render",value:function(){return this.state.toMatch?r.a.createElement(b.a,{push:!0,to:{pathname:"/match",state:{match:this.state.match}}}):r.a.createElement("div",{className:"jumbotron"},r.a.createElement("div",{className:"container-fluid text-center"},r.a.createElement(D,null)),r.a.createElement("hr",{className:"my-4"}),r.a.createElement("section",{className:"container-fluid"},r.a.createElement(M,{toMatch:this.toMatch})))}}]),t}(n.Component),J=(a(42),a(19)),U=a.n(J);U.a.logToConsole=!0;var T=a(20);function A(e){return r.a.createElement("form",{onSubmit:e.handleSubmit},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"form-group text-center container col-md-4 offset-md-4"},r.a.createElement("label",{htmlFor:"selectPlayer"},"S\xe9lectionner un joueur :"),r.a.createElement("select",{className:"form-control",id:"selectPlayer",onChange:e.handleChangeJoueur,defaultValue:e.joueur1.prenom+" "+e.joueur1.nom,required:!0},r.a.createElement("option",null,e.joueur1.prenom," ",e.joueur1.nom),r.a.createElement("option",null,e.joueur2.prenom," ",e.joueur2.nom)))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"form-group text-center container col-md-4 offset-md-4"},r.a.createElement("label",{htmlFor:"montant"},"Montant :"),r.a.createElement("input",{type:"number",className:"form-control",id:"montant",required:!0,onChange:e.handleChangeMontant}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"form-group container-fluid text-center"},r.a.createElement("input",{type:"submit",disabled:e.pariDone,className:"btn btn-lg "+(e.pariDone?"btn-warning":"btn-success"),value:e.pariDone?"Pari Effectu\xe9":"Parier"}))))}var W=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(i.a)(this,Object(m.a)(t).call(this,e))).callApi=Object(v.a)(E.a.mark(function e(){var t,n;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("parties/".concat(a.state.match.id,"/pari"),{method:"POST",headers:{"Content-Type":"application/json","X-Socket-Id":a.pusher.connection.socket_id},body:JSON.stringify({montantPari:a.state.montant})});case 2:return t=e.sent,e.next=5,t.json();case 5:if(n=e.sent,200===t.status){e.next=8;break}throw Error(n.message);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}},e,this)})),a.state={match:[],data:!1,montant:null,joueur:"",pariDone:!1},a.doPari=a.doPari.bind(Object(p.a)(Object(p.a)(a))),a.changeJoueur=a.changeJoueur.bind(Object(p.a)(Object(p.a)(a))),a.changeMontant=a.changeMontant.bind(Object(p.a)(Object(p.a)(a))),a.subscribePusher=a.subscribePusher.bind(Object(p.a)(Object(p.a)(a))),a.pusher=new U.a("5309ab04bb80de5c4e76",{cluster:"us2",forceTLS:!0}),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){if(this.props.location.state){var e=this.props.location.state.match;this.setState({match:e,data:!0,joueur:e.joueur1.prenom})}}},{key:"subscribePusher",value:function(e){var t=this.pusher.subscribe("notifications");t.bind("pusher:subscription_succeeded",function(e){console.log("Subscription succeeded !")}),t.bind("pari",function(e){var t;localStorage.getItem("joueurPari")===e.nomJoueur?(t=new Notification("Gagn\xe9 !!",{body:"Vous gagnez "+e.montant+"$ pour avoir pari\xe9 sur "+e.nomJoueur})).onclick=function(e){e.preventDefault(),t.close()}:(t=new Notification("Perdu !!",{body:"Vous perdez votre mise pour avoir pari\xe9 sur "+e.nomJoueur})).onclick=function(e){e.preventDefault(),t.close()},localStorage.removeItem("joueurPari"),localStorage.removeItem("montantPari")})}},{key:"doPari",value:function(e){var t=this;e.preventDefault(),this.callApi().then(function(e){t.setState({pariDone:!0}),localStorage.setItem("joueurPari",t.state.joueur.split(" ")[1]),localStorage.setItem("montantPari",t.state.montant),t.subscribePusher()}).catch(function(e){return console.log("Erreur",e)})}},{key:"changeJoueur",value:function(e){this.setState({joueur:e.target.value})}},{key:"changeMontant",value:function(e){this.setState({montant:e.target.value})}},{key:"render",value:function(){return this.props.location.state?r.a.createElement("section",{className:"jumbotron text-center"},r.a.createElement("h1",null,"Fais ton pari !"),r.a.createElement("hr",{className:"my-4"}),r.a.createElement("div",null,r.a.createElement(T,{loaded:this.state.data},r.a.createElement(A,{handleSubmit:this.doPari,handleChangeJoueur:this.changeJoueur,handleChangeMontant:this.changeMontant,joueur1:this.state.match.joueur1,joueur2:this.state.match.joueur2,pariDone:this.state.pariDone})))):r.a.createElement(b.a,{push:!0,to:{pathname:"/"}})}}]),t}(n.Component),_=function(e){function t(e){var a;return Object(l.a)(this,t),a=Object(i.a)(this,Object(m.a)(t).call(this,e)),Notification.requestPermission(),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(h.a,null,r.a.createElement(d.a,{exact:!0,path:"/",component:I}),r.a.createElement(d.a,{path:"/match",component:S}),r.a.createElement(d.a,{path:"/pari",component:W}),r.a.createElement(d.a,{component:I}))}}]),t}(n.Component),V=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function L(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}a(44);var q=a(48);o.a.render(r.a.createElement(q.a,{path:"/"},r.a.createElement(_,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("","/service-worker.js");V?(function(e,t){fetch(e).then(function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):L(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):L(t,e)})}}()}},[[21,2,1]]]);
//# sourceMappingURL=main.57b36e20.chunk.js.map